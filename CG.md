#### 垃圾回收机制

1. 引用计数

   ​	当一个对象被创建时，引用计数+1，当对象被引用时，如b = a时,引用计数+1，当引用对象被删除时，引用计数-1，直到引用计数为0时，回收对象。

2. 标记清除

   ​	当循环引用出现时，无法用引用计数来回收对象。

   ```
   a=[1,2]
   b=[2,3]
   a.append(b)
   b.append(a)
   DEL a
   #执行或不执行该命令
   DEL b
   ```

   标记清除两个阵营，一个为root链表，一个为unreachable链表。在删除对象引用前，a和b的引用计数都为2，当删除a时，会递归删除子对象引用。但存在删除a命令执行时，a的引用计数为0，则不执行删除b命令，同样存在b中的a对象已经销毁的情况，则b会出现无效，所以这时候就引入unreachable链表。该链表中对象为垃圾对象，可进行回收。

3. 分代回收

   将对象分为三代，0代表幼年对象，1代表青年对象，2代表老年对象。通常情况下创建对象==回收对象，但出现循环引用时，则创建对象>回收对象。当创建对象-回收对象=阈值时。分代回收就来了。

参考：https://juejin.im/post/5b34b117f265da59a50b2fbe